{
    "contents" : "---\ntitle: \"Reproducible Research: Peer Assessment 1\"\noutput: \n  html_document:\n    keep_md: true\n---\n## Load Packages\nFirst of all, my script uses some packages, so we must install and load\nthem if necessary.\n\n```{r}\nif(\"knitr\" %in% rownames(installed.packages()) == FALSE) \n{install.packages(\"knitr\")}\nlibrary(knitr)\nif(\"dplyr\" %in% rownames(installed.packages()) == FALSE) \n{install.packages(\"dplyr\")}\nlibrary(dplyr)\nif(\"lattice\" %in% rownames(installed.packages()) == FALSE) \n{install.packages(\"lattice\")}\nlibrary(lattice)\n```\n\n\n## Loading and preprocessing the data\n```{r}\nact <- read.csv(\"activity.csv\")\nact <- tbl_df(act)\n```\n\n\n## What is mean total number of steps taken per day?\nI use the dplyr package to create a data table of total steps per day. I also save, \nas objects, the mean and median.\n\n```{r}\nmeansteps <- act %>% group_by(date) %>% select(date, steps) %>% summarise_each(funs(sum))\nmean <- as.integer(mean(meansteps$steps, na.rm = T))\nmed <- as.integer(median(meansteps$steps, na.rm = T))\n```\n\nThe plot:\n```{r, echo=TRUE,}\nhist(meansteps$steps, breaks = 20, main = \"Mean Steps/Day Histogram\", \n     xlab = \"Mean Steps/Day\", ylab = \"Frequency\")\nabline(v = mean, col = \"blue\", lwd = 2)\nabline(v = med, col = \"red\", lwd = 2, lty = 2)\nlegend(\"topright\", legend = paste(c(\"Mean\", \"Median\"), c(mean, med), \n                                  sep = \" = \"), col=c(\"blue\", \"red\"), lwd=2)\n```\n\n\n## What is the average daily activity pattern?\nI create a data table with the mean steps for each interval across all days.\n\n```{r}\nintmeans <- act %>% group_by(interval) %>% select(interval, steps) %>% \n     summarise_each(funs(mean(., na.rm = T)))\n```\n\nThe plot:\n```{r, echo=TRUE}\nplot(intmeans$interval, intmeans$steps, type = \"l\", main = \"Mean Steps/Interval\", \n     xlab = \"Interval\", ylab = \"Steps\")\nabline(v = intmeans[which(intmeans$steps == max(intmeans$steps, na.rm = T)),1],\n       col = \"red\", lwd = 1)\nlegend(\"topright\", col = \"red\", lwd = 1, legend = paste(\"Max Steps Interval\", \n          intmeans[which(intmeans$steps == max(intmeans$steps, na.rm = T)),1], sep = \" = \"))\n```\n\nInterval 835 achieved the highest average number of steps. Congratulations, 835!\n\n\n## Imputing missing values\nFor all NA values in the orginal data, I inserted the average number of steps for that interval.\n\n```{r}\nactfilled <- tbl_df(act)\nmeanstepsfilled <- actfilled %>% group_by(date) %>% select(date, steps) %>% summarise_each(funs(sum))\nmean <- as.integer(mean(meanstepsfilled$steps, na.rm = T))\nmed <- as.integer(median(meanstepsfilled$steps, na.rm = T))\n```\n\nWe see from the following plot that this does not change the mean and only slightly changes\nthe median.\n\n```{r, echo=TRUE}\nhist(meanstepsfilled$steps, breaks = 20, main = \"Mean Steps/Day Histogram 2\", \n     xlab = \"Mean Steps/Day\", ylab = \"Frequency\")\nabline(v = mean, col = \"blue\", lwd = 2)\nabline(v = med, col = \"red\", lwd = 2, lty = 2)\nlegend(\"topright\", legend = paste(c(\"Mean\", \"Median\"), c(mean, med), \n                                  sep = \" = \"), col=c(\"blue\", \"red\"), lwd=2)\n```\n\nOf course the total daily number of steps did increase by 86,129.5.\n\n```{r}\ndiff <- sum(meanstepsfilled$steps, na.rm = T) - sum(meansteps$steps, na.rm = T)\n```\n\n## Are there differences in activity patterns between weekdays and weekends?\nTo explore this question, we must first properly categorize each date as a \"Weekday\" or\n\"Weekend\". Then we create a data table for the mean number of steps for each interval\ngrouped by the type of day.\n\n```{r}\nactdays <- as.data.frame(act)\nactdays$date <- as.POSIXlt(actdays$date)\nactdays$day <- weekdays(actdays$date)\nactdays[,\"type\"] <- NA\nfor(i in 1:nrow(actdays)){\n     if(actdays[i,4] == \"Saturday\"| actdays[i,4] == \"Sunday\"){\n        actdays[i,5] <- \"Weekend\"\n     }else{\n          actdays[i,5] <- \"Weekday\"\n     }\n     }\nactdays$date <- as.character(actdays$date)\nactdays <- tbl_df(actdays)\nwkend <- actdays %>% group_by(interval, type) %>% select(interval,type,steps) %>% \n     summarise_each(funs(mean(.,na.rm = T)))\n```\n\nThe plot shows us that the mean number of steps on a weekend is lower before about\ninterval 900, but is generally higher for the rest of the day. \n\n```{r, echo=TRUE}\nxyplot(steps~interval|type, ylab=\"Steps\", xlab=\"Interval\", \n main=\"Steps/Interval by Day Type\", layout=(c(1,2)), type = \"l\", data = wkend)\n```\n\n",
    "created" : 1423173445442.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "35433245",
    "id" : "5128A4D",
    "lastKnownWriteTime" : 1423174074,
    "path" : "~/Coursera/R Programming/RepData_PeerAssessment1/PA1_template.Rmd",
    "project_path" : "PA1_template.Rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}